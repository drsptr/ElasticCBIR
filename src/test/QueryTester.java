package test;

import it.unipi.ing.drsptr.elastic.img.ElasticImageIndexManager;
import it.unipi.ing.drsptr.elastic.img.tools.Fields;
import it.unipi.ing.drsptr.elastic.txt.ElasticIndexManager;
import it.unipi.ing.drsptr.elastic.utilities.JsonDocParser;
import it.unipi.ing.drsptr.elastic.utilities.JsonDocParserFieldNotFoundException;
import it.unipi.ing.mim.deep.ImgDescriptor;
import it.unipi.ing.mim.deep.tools.Output;
import org.elasticsearch.action.get.GetResponse;
import org.elasticsearch.action.search.SearchResponse;

import java.io.File;
import java.io.IOException;
import java.net.InetAddress;
import java.net.UnknownHostException;
import java.util.Arrays;
import java.util.Collections;
import java.util.List;

/**
 * Created by Pietro on 2/7/2017.
 *
 *
 * claudiotest.isti.cnr.it [146.48.86.226]  0,1 x
 * virserv04.isti.cnr.it [146.48.86.242]    2,3 x
 * virserv101.isti.cnr.it [146.48.85.168]   11,14 x
 * virserv102.isti.cnr.it [146.48.87.51]    6,7 x
 * nemis-guest.isti.cnr.it [146.48.87.225]  8,9 x
 * dlearning.isti.cnr.it [146.48.87.41]     4,15 x
 * pc-carrara.isti.cnr.it [146.48.86.29]    12,13 x
 * mutalisca.isti.cnr.it [146.48.87.145]    5,10 x
 */


public class QueryTester {

    public static final String CLUSTERNAME = "elasticCbirYFCC100M";
    public static final String ADDRESS = "146.48.85.168";
    public static final String INDEX_NAME = "cbir";
    public static final String TYPE_NAME = "yfcc100m";

    /**************        50      **************/
    //public static final List<String> IDs = Collections.unmodifiableList(	Arrays.asList("9023354929", "4037066110", "285662379", "12121248795", "6539911487", "1508517791", "3507937798", "5932335388", "11296639863", "4369163697", "6476096415", "2383052364", "1564194881", "11524532714", "5625094414", "3597708244", "4029677763", "7120387901", "3897693643", "11241953044", "1745873301", "9582047987", "6377163343", "6584813585", "7548169248", "8090318427", "245068398", "4183190227", "7265786750", "5509261578", "3812953086", "4681530725", "307417742", "8196976139", "8098796043", "4320679429", "4554398971", "5852495836", "6898219857", "12214674466", "8285514033", "3871488732", "3522916719", "3378409688", "816430028", "7547865408", "4920068715", "8376946506", "8457303171", "4848565876"));
    //public static final List<String> IDs = Collections.unmodifiableList(	Arrays.asList("9023354929", "505098234", "4037066110", "285662379", "3992786572", "3234808728", "12121248795", "6539911487", "1508517791", "3507937798", "2234563729", "2373550303", "6996551832", "5932335388", "11296639863", "3159282054", "4369163697", "3731102359", "6476096415", "7642424216", "5509632892", "3543253439", "2383052364", "1564194881", "6286600655", "11524532714", "5625094414", "3597708244", "13448434485", "5407058821", "2562455157", "4029677763", "7120387901", "9711976293", "3897693643", "4693669825", "9434008092", "4708649104", "11241953044", "1745873301", "9582047987", "6377163343", "6584813585", "8190959757", "6046513984", "7421677664", "7548169248", "8090318427", "2382525439", "6397020439") );
    //public static final List<String> IDs = Collections.unmodifiableList(	Arrays.asList("9023354929", "505098234", "8353460090", "4037066110", "285662379", "3992786572", "3234808728", "12121248795", "6539911487", "1508517791", "3507937798", "2234563729", "2373550303", "6996551832", "6234659612", "5932335388", "11296639863", "3159282054", "8724728801", "4755238850", "7156074769", "4369163697", "3731102359", "7967632834", "153700419", "6476096415", "7642424216", "5509632892", "8231333232", "3543253439", "2383052364", "1564194881", "6286600655", "6014830301", "11524532714", "6123554332", "8254297477", "5625094414", "3597708244", "13448434485", "5407058821", "2562455157", "4029677763", "7120387901", "9711976293", "3897693643", "4693669825", "9434008092", "4708649104", "11241953044") );
    //public static final List<String> IDs = Collections.unmodifiableList(	Arrays.asList("9023354929", "505098234", "4005289181", "3360296927", "8353460090", "4037066110", "285662379", "3992786572", "3234808728", "12121248795", "6539911487", "1508517791", "3507937798", "8006784397", "2234563729", "5027536744", "6975534525", "2373550303", "6996551832", "6234659612", "3959605103", "5932335388", "11296639863", "3159282054", "4429010611", "8724728801", "4755238850", "7156074769", "4369163697", "3731102359", "1555797374", "11982628165", "7967632834", "153700419", "6476096415", "7642424216", "5509632892", "8231333232", "8517925323", "3543253439", "2383052364", "1564194881", "6286600655", "6014830301", "5025842756", "11524532714", "6123554332", "8254297477", "5625094414", "3597708244") );
    //public static final List<String> IDs = Collections.unmodifiableList(	Arrays.asList("9023354929", "505098234", "4005289181", "3360296927", "282376326", "2460082100", "8353460090", "10869611614", "3121283324", "4037066110", "285662379", "3992786572", "3234808728", "13902785393", "7741824756", "12121248795", "6539911487", "1508517791", "3507937798", "8006784397", "5940804748", "2234563729", "5027536744", "9787177115", "6975534525", "2373550303", "6996551832", "6234659612", "3959605103", "5932335388", "11296639863", "3159282054", "4429010611", "8724728801", "4755238850", "8699194278", "7156074769", "4369163697", "3731102359", "1555797374", "11982628165", "5510063830", "7967632834", "153700419", "6476096415", "7642424216", "7170448323", "13916504101", "5509632892", "8231333232") );
    //public static final List<String> IDs = Collections.unmodifiableList(	Arrays.asList("9023354929", "505098234", "4005289181", "3360296927", "282376326", "2460082100", "8353460090", "10869611614", "3121283324", "4037066110", "285662379", "3992786572", "3234808728", "13902785393", "7741824756", "12121248795", "6539911487", "1508517791", "3507937798", "8006784397", "5940804748", "2234563729", "5027536744", "9787177115", "6975534525", "9987589996", "2373550303", "6996551832", "6234659612", "3959605103", "3761869902", "5932335388", "11296639863", "3159282054", "4429010611", "8724728801", "441706685", "4755238850", "8699194278", "9428552321", "7156074769", "4369163697", "3731102359", "1555797374", "11982628165", "5510063830", "4729633585", "7967632834", "9160721801", "153700419") );
    //public static final List<String> IDs = Collections.unmodifiableList(	Arrays.asList("9023354929", "505098234", "4005289181", "3360296927", "282376326", "2460082100", "6260744191", "8353460090", "10869611614", "3121283324", "4037066110", "285662379", "3992786572", "3234808728", "13902785393", "7741824756", "12121248795", "6539911487", "1508517791", "3507937798", "8006784397", "5940804748", "6283000562", "2234563729", "5027536744", "9787177115", "6975534525", "8528371125", "9987589996", "2373550303", "6996551832", "6234659612", "3959605103", "3761869902", "5932335388", "11296639863", "3159282054", "4429010611", "6795851272", "8724728801", "441706685", "4755238850", "8699194278", "9428552321", "7156074769", "4369163697", "3731102359", "1555797374", "11982628165", "5510063830") );
    //public static final List<String> IDs = Collections.unmodifiableList(	Arrays.asList("9023354929", "505098234", "4005289181", "3360296927", "282376326", "2460082100", "6260744191", "8353460090", "10869611614", "3121283324", "4037066110", "285662379", "3992786572", "3234808728", "8259776744", "13902785393", "7741824756", "12121248795", "6539911487", "1508517791", "3507937798", "8006784397", "5940804748", "6283000562", "2234563729", "5027536744", "9787177115", "6975534525", "8528371125", "9987589996", "2373550303", "6996551832", "6869731706", "6234659612", "3959605103", "3563046794", "490043074", "3761869902", "5932335388", "11296639863", "3159282054", "4429010611", "6795851272", "8724728801", "441706685", "4755238850", "8699194278", "9428552321", "7156074769", "4369163697") );


    /**************        100      **************/
    //public static final List<String> IDs = Collections.unmodifiableList(	Arrays.asList("9023354929", "4037066110", "285662379", "12121248795", "6539911487", "1508517791", "3507937798", "5932335388", "11296639863", "4369163697", "6476096415", "2383052364", "1564194881", "11524532714", "5625094414", "3597708244", "4029677763", "7120387901", "3897693643", "11241953044", "1745873301", "9582047987", "6377163343", "6584813585", "7548169248", "8090318427", "245068398", "4183190227", "7265786750", "5509261578", "3812953086", "4681530725", "307417742", "8196976139", "8098796043", "4320679429", "4554398971", "5852495836", "6898219857", "12214674466", "8285514033", "3871488732", "3522916719", "3378409688", "816430028", "7547865408", "4920068715", "8376946506", "8457303171", "4848565876", "5539209241", "9046091899", "4584420217", "2761395274", "8098536588", "6258705740", "6312612060", "3718368954", "4105181151", "8181445677", "1557652127", "2215865427", "5252159617", "2923892986", "1014914201", "2548317773", "969999408", "9734738534", "2832900131", "55755542", "3106146239", "6958878605", "13043020753", "2872225207", "2365436765", "8325206511", "859188957", "4668700296", "8264233895", "13611595744", "4392890832", "496502499", "4045736690", "3823898356", "11248675103", "2997669719", "2396459927", "6513846189", "8157071527", "3724547713", "2162324877", "9218149108", "3756448514", "4866133219", "2087738673", "5842934915", "8689467089", "11494146915", "4036924765", "13136074864"));
    //public static final List<String> IDs = Collections.unmodifiableList(	Arrays.asList("9023354929", "505098234", "4037066110", "285662379", "3992786572", "3234808728", "12121248795", "6539911487", "1508517791", "3507937798", "2234563729", "2373550303", "6996551832", "5932335388", "11296639863", "3159282054", "4369163697", "3731102359", "6476096415", "7642424216", "5509632892", "3543253439", "2383052364", "1564194881", "6286600655", "11524532714", "5625094414", "3597708244", "13448434485", "5407058821", "2562455157", "4029677763", "7120387901", "9711976293", "3897693643", "4693669825", "9434008092", "4708649104", "11241953044", "1745873301", "9582047987", "6377163343", "6584813585", "8190959757", "6046513984", "7421677664", "7548169248", "8090318427", "2382525439", "6397020439", "2451516710", "245068398", "4183190227", "8223445277", "7265786750", "1461695420", "5509261578", "484212873", "3812953086", "409704360", "6000622868", "1323826932", "4681530725", "307417742", "13952565976", "9190283142", "363044204", "8196976139", "5542512344", "8098796043", "5576130549", "4055771176", "4816843660", "7937835450", "11486243233", "5987457781", "4320679429", "4554398971", "5195759238", "2500187351", "7991990921", "9971955403", "2309941500", "5072430480", "5883958127", "3025863623", "10674689624", "5852495836", "8903491186", "6898219857", "12214674466", "8285514033", "3871488732", "2757046364", "12035117414", "3522916719", "13752194413", "7917278822", "3378409688", "816430028"));
    //public static final List<String> IDs = Collections.unmodifiableList(	Arrays.asList("9023354929", "505098234", "8353460090", "4037066110", "285662379", "3992786572", "3234808728", "12121248795", "6539911487", "1508517791", "3507937798", "2234563729", "2373550303", "6996551832", "6234659612", "5932335388", "11296639863", "3159282054", "8724728801", "4755238850", "7156074769", "4369163697", "3731102359", "7967632834", "153700419", "6476096415", "7642424216", "5509632892", "8231333232", "3543253439", "2383052364", "1564194881", "6286600655", "6014830301", "11524532714", "6123554332", "8254297477", "5625094414", "3597708244", "13448434485", "5407058821", "2562455157", "4029677763", "7120387901", "9711976293", "3897693643", "4693669825", "9434008092", "4708649104", "11241953044", "1745873301", "5859940851", "4103763962", "449184359", "14009259301", "9582047987", "6377163343", "6584813585", "8190959757", "6046513984", "7421677664", "7548169248", "8090318427", "2382525439", "497548196", "4634036586", "6397020439", "10633577024", "131912251", "2451516710", "245068398", "4183190227", "5850013453", "9588333954", "8223445277", "4291132593", "7265786750", "1461695420", "5509261578", "484212873", "3812953086", "409704360", "7640504842", "3171032189", "6000622868", "1323826932", "4866887157", "4681530725", "307417742", "4438306795", "13952565976", "9190283142", "363044204", "3297403807", "8196976139", "2772564308", "5542512344", "2045712020", "8098796043", "3658272553"));
    //public static final List<String> IDs = Collections.unmodifiableList(	Arrays.asList("9023354929", "505098234", "4005289181", "3360296927", "8353460090", "4037066110", "285662379", "3992786572", "3234808728", "12121248795", "6539911487", "1508517791", "3507937798", "8006784397", "2234563729", "5027536744", "6975534525", "2373550303", "6996551832", "6234659612", "3959605103", "5932335388", "11296639863", "3159282054", "4429010611", "8724728801", "4755238850", "7156074769", "4369163697", "3731102359", "1555797374", "11982628165", "7967632834", "153700419", "6476096415", "7642424216", "5509632892", "8231333232", "8517925323", "3543253439", "2383052364", "1564194881", "6286600655", "6014830301", "5025842756", "11524532714", "6123554332", "8254297477", "5625094414", "3597708244", "13448434485", "4844165470", "12264171586", "3393694243", "5407058821", "2562455157", "4029677763", "7120387901", "9711976293", "6750514299", "3897693643", "4693669825", "9434008092", "4708649104", "11241953044", "1745873301", "5859940851", "2115300813", "4103763962", "5616512417", "449184359", "14009259301", "7275693232", "9582047987", "6377163343", "6584813585", "8190959757", "6046513984", "1499969741", "7421677664", "7548169248", "8090318427", "2382525439", "497548196", "4634036586", "6397020439", "10633577024", "131912251", "2451516710", "4738755336", "4133092437", "245068398", "4183190227", "5850013453", "6004511997", "9588333954", "5105599624", "3951906161", "8223445277", "4291132593"));
    //public static final List<String> IDs = Collections.unmodifiableList(	Arrays.asList("9023354929", "505098234", "4005289181", "3360296927", "282376326", "2460082100", "8353460090", "10869611614", "3121283324", "4037066110", "285662379", "3992786572", "3234808728", "13902785393", "7741824756", "12121248795", "6539911487", "1508517791", "3507937798", "8006784397", "5940804748", "2234563729", "5027536744", "9787177115", "6975534525", "2373550303", "6996551832", "6234659612", "3959605103", "5932335388", "11296639863", "3159282054", "4429010611", "8724728801", "4755238850", "8699194278", "7156074769", "4369163697", "3731102359", "1555797374", "11982628165", "5510063830", "7967632834", "153700419", "6476096415", "7642424216", "7170448323", "13916504101", "5509632892", "8231333232", "8517925323", "2063460928", "3543253439", "2211244846", "2383052364", "1564194881", "6286600655", "6014830301", "5025842756", "4431429696", "11524532714", "6123554332", "8254297477", "5625094414", "3597708244", "13448434485", "4844165470", "3028669468", "1588799034", "12264171586", "3393694243", "13568160754", "5407058821", "2562455157", "4808857464", "4029677763", "7120387901", "9711976293", "6750514299", "3897693643", "4693669825", "9434008092", "4708649104", "6250716056", "6154174589", "11241953044", "1745873301", "5859940851", "2115300813", "4103763962", "5616512417", "449184359", "14009259301", "7275693232", "9582047987", "6377163343", "6584813585", "8190959757", "6046513984", "1499969741"));
    //public static final List<String> IDs = Collections.unmodifiableList(	Arrays.asList("9023354929", "505098234", "4005289181", "3360296927", "282376326", "2460082100", "8353460090", "10869611614", "3121283324", "4037066110", "285662379", "3992786572", "3234808728", "13902785393", "7741824756", "12121248795", "6539911487", "1508517791", "3507937798", "8006784397", "5940804748", "2234563729", "5027536744", "9787177115", "6975534525", "9987589996", "2373550303", "6996551832", "6234659612", "3959605103", "3761869902", "5932335388", "11296639863", "3159282054", "4429010611", "8724728801", "441706685", "4755238850", "8699194278", "9428552321", "7156074769", "4369163697", "3731102359", "1555797374", "11982628165", "5510063830", "4729633585", "7967632834", "9160721801", "153700419", "6476096415", "7642424216", "7170448323", "13916504101", "7181733513", "5509632892", "8231333232", "8517925323", "2063460928", "12847049235", "3543253439", "2211244846", "2383052364", "1564194881", "6286600655", "6014830301", "5025842756", "4431429696", "11655195124", "5552912100", "11524532714", "6123554332", "8254297477", "5625094414", "3597708244", "13448434485", "607757532", "4844165470", "3028669468", "1588799034", "6174129941", "12264171586", "3393694243", "13568160754", "5005403227", "5407058821", "2562455157", "4808857464", "4029677763", "7120387901", "9711976293", "6750514299", "170254902", "2481581176", "3897693643", "4693669825", "9434008092", "4708649104", "6250716056", "6154174589"));
    public static final List<String> IDs = Collections.unmodifiableList(	Arrays.asList("9023354929", "505098234", "4005289181", "3360296927", "282376326", "2460082100", "6260744191", "8353460090", "10869611614", "3121283324", "4037066110", "285662379", "3992786572", "3234808728", "13902785393", "7741824756", "12121248795", "6539911487", "1508517791", "3507937798", "8006784397", "5940804748", "6283000562", "2234563729", "5027536744", "9787177115", "6975534525", "8528371125", "9987589996", "2373550303", "6996551832", "6234659612", "3959605103", "3761869902", "5932335388", "11296639863", "3159282054", "4429010611", "6795851272", "8724728801", "441706685", "4755238850", "8699194278", "9428552321", "7156074769", "4369163697", "3731102359", "1555797374", "11982628165", "5510063830", "4729633585", "3040994832", "7967632834", "3538642548", "9160721801", "153700419", "4948016132", "6476096415", "7642424216", "7170448323", "13916504101", "7181733513", "5497480818", "957721624", "5509632892", "8231333232", "8517925323", "2063460928", "12847049235", "1455057148", "3543253439", "2211244846", "2383052364", "1564194881", "6286600655", "6014830301", "5025842756", "4431429696", "11655195124", "5552912100", "11524532714", "6123554332", "8254297477", "5625094414", "3597708244", "13448434485", "607757532", "4844165470", "3028669468", "1588799034", "7448909864", "10856632216", "6174129941", "12264171586", "3393694243", "13568160754", "85264236", "5005403227", "5407058821", "2562455157"));
    //public static final List<String> IDs = Collections.unmodifiableList(	Arrays.asList("9023354929", "505098234", "4005289181", "3360296927", "282376326", "2460082100", "6260744191", "8353460090", "10869611614", "3121283324", "4037066110", "285662379", "3992786572", "3234808728", "8259776744", "13902785393", "7741824756", "12121248795", "6539911487", "1508517791", "3507937798", "8006784397", "5940804748", "6283000562", "2234563729", "5027536744", "9787177115", "6975534525", "8528371125", "9987589996", "2373550303", "6996551832", "6869731706", "6234659612", "3959605103", "3563046794", "490043074", "3761869902", "5932335388", "11296639863", "3159282054", "4429010611", "6795851272", "8724728801", "441706685", "4755238850", "8699194278", "9428552321", "7156074769", "4369163697", "3731102359", "1555797374", "11982628165", "5510063830", "4729633585", "3040994832", "7967632834", "3538642548", "9160721801", "153700419", "8625605421", "4948016132", "6476096415", "7642424216", "8287671759", "7170448323", "13916504101", "7181733513", "5497480818", "957721624", "5509632892", "8231333232", "8517925323", "2063460928", "4815948380", "12847049235", "1455057148", "3543253439", "2211244846", "2383052364", "1564194881", "6286600655", "6014830301", "5025842756", "4431429696", "11655195124", "5552912100", "11524532714", "481538267", "6123554332", "8254297477", "5625094414", "3597708244", "13448434485", "607757532", "4844165470", "3028669468", "1588799034", "7448909864", "10856632216"));

    public static final String[] SHARDS = {/*"0,1", "0,1,2,3", "0,1,2,3,11,14", "0,1,2,3,11,14,6,7", "0,1,2,3,11,14,6,7,8,9", "0,1,2,3,11,14,6,7,8,9,4,15", */"0,1,2,3,11,14,6,7,8,9,4,15,12,13"};//, "0,1,2,3,11,14,6,7,8,9,4,15,12,13,5,10"};
    public static void main(String[] args) throws UnknownHostException, IOException, ClassNotFoundException, JsonDocParserFieldNotFoundException{
        ElasticImageIndexManager manager = new ElasticImageIndexManager(CLUSTERNAME, 30);
        manager.connectTo(InetAddress.getByName(ADDRESS), 9300);

        for(int i=0; i<SHARDS.length; i++) {
            for (String id : IDs) {
                List<ImgDescriptor> imgs = manager.visualSearchQROnShards(INDEX_NAME, TYPE_NAME, SHARDS[i], id, 10, 120);
                //Output.toHTML(imgs, new File("C:\\Users\\Pietro\\Desktop\\out.html"));
            }
        }
        manager.close();
    }
}